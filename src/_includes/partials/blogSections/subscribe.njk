<section class = "subscribe">
    <div class = "subscribe__left">
        <h3>Subscribe to our Newsletter</h3>
        <p>Get the latest tips, tools, and updates to help you run a smarter, more efficient gymâ€”delivered straight to your inbox.</p>
    </div>
    <div class = "subscribe__right">
        <form id = "subscribeForm" action = "/pages/blog" method = "POST" name = "subscribeForm" netlify>
            <div class = "input-pair">
                <input id = "subscribeEmail" name = "subscribeEmail" type="email" placeholder = "Email Address" required />
            </div>
            <button type="submit" form="subscribeForm" value="Submit">Subscribe</button>
        </form>
    </div>
</section>

<div id="formConfirmationModal" class = "formConfirmation" style="display: none;">
    <div class="formConfirmation-content">
        <p>Thanks for subscribing!</p>
        <button id="closeConfirmation">Close</button>
    </div>
</div>

<script>
document.addEventListener("DOMContentLoaded", () => {
  // Set form action
  const subscribeForm = document.getElementById("subscribeForm");
  if (subscribeForm) {
    const currentPath = window.location.pathname;
    const searchParams = new URLSearchParams(window.location.search);
    searchParams.set("submitted", "true");
    subscribeForm.setAttribute("action", `${currentPath}?${searchParams.toString()}`);
  }

  // Handle modal display
  const urlParams = new URLSearchParams(window.location.search);
  const modal = document.getElementById("formConfirmationModal");
  const closeBtn = document.getElementById("closeConfirmation");

  if (urlParams.get("submitted") === "true" && modal) {
    modal.style.display = "flex";
    history.replaceState({}, document.title, window.location.pathname);
  }

  if (closeBtn && modal) {
    closeBtn.addEventListener("click", () => {
      modal.style.display = "none";
    });
  }
});
</script>